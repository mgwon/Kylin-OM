{
  "panel_title": "CPU",
  "panel_id": 3,
  "description": "CPU time usage split by state, normalized across all CPU cores",
  "targets": [
    {
      "refId": "A",
      "query": "sum(irate(node_cpu_seconds_total{mode=\"system\",instance=\"localhost:9100\",job=\"node_exporter\"}[5m])) / scalar(count(count(node_cpu_seconds_total{instance=\"localhost:9100\",job=\"node_exporter\"}) by (cpu)))",
      "legendFormat": "System - Processes executing in kernel mode",
      "hidden": false,
      "result": {
        "status": "success",
        "data": {
          "resultType": "matrix",
          "result": []
        }
      }
    },
    {
      "refId": "B",
      "query": "sum(irate(node_cpu_seconds_total{mode=\"user\",instance=\"localhost:9100\",job=\"node_exporter\"}[5m])) / scalar(count(count(node_cpu_seconds_total{instance=\"localhost:9100\",job=\"node_exporter\"}) by (cpu)))",
      "legendFormat": "User - Normal processes executing in user mode",
      "hidden": false,
      "result": {
        "status": "success",
        "data": {
          "resultType": "matrix",
          "result": []
        }
      }
    },
    {
      "refId": "C",
      "query": "sum(irate(node_cpu_seconds_total{mode=\"nice\",instance=\"localhost:9100\",job=\"node_exporter\"}[5m])) / scalar(count(count(node_cpu_seconds_total{instance=\"localhost:9100\",job=\"node_exporter\"}) by (cpu)))",
      "legendFormat": "Nice - Niced processes executing in user mode",
      "hidden": false,
      "result": {
        "status": "success",
        "data": {
          "resultType": "matrix",
          "result": []
        }
      }
    },
    {
      "refId": "D",
      "query": "sum(irate(node_cpu_seconds_total{mode=\"iowait\",instance=\"localhost:9100\",job=\"node_exporter\"}[5m])) / scalar(count(count(node_cpu_seconds_total{instance=\"localhost:9100\",job=\"node_exporter\"}) by (cpu)))",
      "legendFormat": "Iowait - Waiting for I/O to complete",
      "hidden": false,
      "result": {
        "status": "success",
        "data": {
          "resultType": "matrix",
          "result": []
        }
      }
    },
    {
      "refId": "E",
      "query": "sum(irate(node_cpu_seconds_total{mode=\"irq\",instance=\"localhost:9100\",job=\"node_exporter\"}[5m])) / scalar(count(count(node_cpu_seconds_total{instance=\"localhost:9100\",job=\"node_exporter\"}) by (cpu)))",
      "legendFormat": "Irq - Servicing interrupts",
      "hidden": false,
      "result": {
        "status": "success",
        "data": {
          "resultType": "matrix",
          "result": []
        }
      }
    },
    {
      "refId": "F",
      "query": "sum(irate(node_cpu_seconds_total{mode=\"softirq\",instance=\"localhost:9100\",job=\"node_exporter\"}[5m])) / scalar(count(count(node_cpu_seconds_total{instance=\"localhost:9100\",job=\"node_exporter\"}) by (cpu)))",
      "legendFormat": "Softirq - Servicing softirqs",
      "hidden": false,
      "result": {
        "status": "success",
        "data": {
          "resultType": "matrix",
          "result": []
        }
      }
    },
    {
      "refId": "G",
      "query": "sum(irate(node_cpu_seconds_total{mode=\"steal\",instance=\"localhost:9100\",job=\"node_exporter\"}[5m])) / scalar(count(count(node_cpu_seconds_total{instance=\"localhost:9100\",job=\"node_exporter\"}) by (cpu)))",
      "legendFormat": "Steal - Time spent in other operating systems when running in a virtualized environment",
      "hidden": false,
      "result": {
        "status": "success",
        "data": {
          "resultType": "matrix",
          "result": []
        }
      }
    },
    {
      "refId": "H",
      "query": "sum(irate(node_cpu_seconds_total{mode=\"idle\",instance=\"localhost:9100\",job=\"node_exporter\"}[5m])) / scalar(count(count(node_cpu_seconds_total{instance=\"localhost:9100\",job=\"node_exporter\"}) by (cpu)))",
      "legendFormat": "Idle - Waiting for something to happen",
      "hidden": false,
      "result": {
        "status": "success",
        "data": {
          "resultType": "matrix",
          "result": []
        }
      }
    },
    {
      "refId": "I",
      "query": "sum by(instance) (irate(node_cpu_guest_seconds_total{instance=\"localhost:9100\",job=\"node_exporter\"}[5m])) / on(instance) group_left sum by (instance)((irate(node_cpu_seconds_total{instance=\"localhost:9100\",job=\"node_exporter\"}[5m]))) > 0",
      "legendFormat": "Guest CPU usage",
      "hidden": false,
      "result": {
        "status": "success",
        "data": {
          "resultType": "matrix",
          "result": []
        }
      }
    }
  ]
}